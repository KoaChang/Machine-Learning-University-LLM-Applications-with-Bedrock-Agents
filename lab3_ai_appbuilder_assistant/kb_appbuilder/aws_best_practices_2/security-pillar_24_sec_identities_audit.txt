{"page_content": "SEC02-BP05 Audit and rotate credentials periodically - Security PillarSEC02-BP05 Audit and rotate credentials periodically - Security PillarAWSDocumentationAWS Well-ArchitectedAWS Well-Architected FrameworkImplementation guidanceResourcesSEC02-BP05 Audit and rotate credentials periodicallyAudit and rotate credentials periodically to limit how long the credentials can be used to access your resources. Long-term credentials create many risks, and these risks can be reduced by rotating long-term credentials regularly.\nDesired outcome: Implement credential rotation to help reduce the risks associated with long-term credential usage. Regularly audit and remediate non-compliance with credential rotation policies.\n  \nCommon anti-patterns:\n\n\n\n        Not auditing credential use.\n      \n\n\n        Using long-term credentials unnecessarily.\n      \n\n\n        Using long-term credentials and not rotating them regularly.\n      \n\nLevel of risk exposed if this best practice\n    is not established: High\n  \nImplementation guidance\n\n      When you cannot rely on temporary credentials and require long-term credentials, audit credentials to verify that defined controls like multi-factor authentication (MFA) are enforced, rotated regularly, and have the appropriate access level.\n    \n\n      Periodic validation, preferably through an automated tool, is necessary to verify that the correct controls are enforced. For human identities, you should require users to change their passwords periodically and retire access keys in favor of temporary credentials. As you move from AWS Identity and Access Management (IAM) users to centralized identities, you can generate a credential report to audit your users. \n    \n\n      We also recommend that you enforce and monitor MFA in your identity provider. You can set up AWS Config Rules, or use AWS Security Hub Security Standards, to monitor if users have configured MFA. Consider using IAM Roles Anywhere to provide temporary credentials for machine identities. In situations when using IAM roles and temporary credentials is not possible, frequent auditing and rotating access keys is necessary.\n    \n\nImplementation steps\n\n\n\n\nRegularly audit credentials: Auditing the identities that are configured in your identity provider and IAM helps verify that only authorized identities have access to your workload. Such identities can include, but are not limited to, IAM users, AWS IAM Identity Center users, Active Directory users, or users in a different upstream identity provider. For example, remove people that leave the organization, and remove cross-account roles that are no longer required. Have a process in place to periodically audit permissions to the services accessed by an IAM entity. This helps you identify the policies you need to modify to remove any unused permissions. Use credential reports and AWS Identity and Access Management Access Analyzer to audit IAM credentials and permissions. You can use Amazon CloudWatch to set up alarms for specific API calls called within your AWS environment. Amazon GuardDuty can also alert you to unexpected activity, which might indicate overly permissive access or unintended access to IAM credentials.\n        \n\n\nRotate credentials regularly: When you are unable to use temporary credentials, rotate long-term IAM access keys regularly (maximum every 90 days). If an access key is unintentionally disclosed without your knowledge, this limits how long the credentials can be used to access your resources. For information about rotating access keys for IAM users, see Rotating access keys.\n        \n\n\nReview IAM permissions: To improve the security of your AWS account, regularly review and monitor each of your IAM policies. Verify that policies adhere to the principle of least privilege.\n        \n\n\nConsider automating IAM resource creation and updates: IAM Identity Center automates many IAM tasks, such as role and policy management. Alternatively, AWS CloudFormation can be used to automate the deployment of IAM resources, including roles and policies, to reduce the chance of human error because the templates can be verified and version controlled.\n        \n\n\nUse IAM Roles Anywhere to replace IAM users for machine identities: IAM Roles Anywhere allows you to use roles in areas that you traditionally could not, such as on-premise servers. IAM Roles Anywhere uses a trusted X.509 certificate to authenticate to AWS and receive temporary credentials. Using IAM Roles Anywhere avoids the need to rotate these credentials, as long-term credentials are no longer stored in your on-premises environment. Please note that you will need to monitor and rotate the X.509 certificate as it approaches expiration.\n        \n\nResources\n\nRelated best practices:\n\n\n\n\nSEC02-BP02 Use temporary credentials\n\n\n\nSEC02-BP03 Store and use secrets securely\n\n\n\nRelated documents:\n\n\n\n\nGetting\n          Started with AWS Secrets Manager\n\n\n\nIAM\n          Best Practices\n\n\n\nIdentity\n          Providers and Federation\n\n\n\nSecurity\n          Partner Solutions: Access and Access Control\n\n\n\nTemporary\n          Security Credentials\n\n\n\n          Getting credential reports for your AWS account\n\n\nRelated videos:\n\n\n\n\nBest Practices\n          for Managing, Retrieving, and Rotating Secrets at Scale\n\n\n\nManaging user\n          permissions at scale with AWS IAM Identity Center\n\n\n\nMastering\n          identity at every layer of the cake\n\n\n\nRelated examples:\n\n\n\n\n          Well-Architected Lab - Automated IAM User Cleanup\n        \n\n\n          Well-Architected Lab - Automated Deployment of IAM Groups and Roles\n        \n\n Javascript is disabled or is unavailable in your browser.To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.Document ConventionsSEC02-BP04 Rely on a centralized identity providerSEC02-BP06 Leverage user groups and attributesDid this page help you? - YesThanks for letting us know we're doing a good job!If you've got a moment, please tell us what we did right so we can do more of it.Did this page help you? - NoThanks for letting us know this page needs work. We're sorry we let you down.If you've got a moment, please tell us how we can make the documentation better.", "metadata": {"source": "https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/sec_identities_audit.html", "title": "SEC02-BP05 Audit and rotate credentials periodically - Security Pillar", "description": "Audit and rotate credentials periodically to limit how long the credentials can be used to access your resources. Long-term credentials create many risks, and these risks can be reduced by rotating long-term credentials regularly.", "language": "en-US"}}